<!-- widget edit box -->
<div class="jarviswidget-editbox">
    <!-- This area used as dropdown edit box -->
</div>
<!-- end widget edit box -->

<!-- widget content -->
<div class="widget-body no-padding">
    <!--/*@thymesVar id="realmodel" type=""*/-->
    <form th:object="${realmodel}" method="POST" th:action="@{/system/org/save}"
          id="realentity" class="smart-form"
          xmlns:th="http://www.thymeleaf.org">
        <fieldset>
            <div class="row">
                <label class="label col col-1" style="font-size: 14px">上级组织机构</label>
                <section class="col col-11">
                    <label class="input">
                        <input type="text" id="pname" name="pname" th:value="${pname}" placeholder="上级组织机构"
                               data-mask="2099" disabled="disabled">
                        <input id="pid" name="pid" type="hidden" th:value="${pid}">

                    </label>
                </section>
            </div>
            <div class="row">
                <section class="col col-6">
                    <label class="input"> <i class="icon-prepend fa fa-user"></i>
                        <input type="text" name="name" th:field="*{name}" placeholder="组织机构名称">
                        <input id="updateflag" name="updateflag" type="hidden" th:value="${realneworupdate}">
                        <input id="updateID" name="updateID" type="hidden" th:value="${realUpdateID}">

                        <b class="tooltip tooltip-bottom-right">字段帮助信息示例</b>
                    </label>
                </section>
                <section class="col col-6">
                    <label class="input"> <i class="icon-prepend fa fa-envelope-o"></i>
                        <input type="text" name="contactName" th:field="*{contactName}" placeholder="联系人">
                    </label>
                </section>
            </div>
            <div class="row">
                <section class="col col-6">
                    <label class="input"> <i class="icon-prepend fa fa-user"></i>
                        <input type="text" id="contactTel" name="contactTel" th:field="*{contactTel}"
                               placeholder="联系电话">
                    </label>
                </section>

                <section class="col col-6">
                    <label class="input"> <i class="icon-prepend fa fa-envelope-o"></i>
                        <input type="text" name="resWeight" th:field="*{resWeight}" placeholder="显示权重">
                    </label>
                </section>
            </div>
        </fieldset>


        <footer>
            <button type="reset" class="btn btn-primary">
                重置数据
            </button>
            <button type="submit" class="btn btn-primary">
                提交数据
            </button>
        </footer>
    </form>

</div>

<script>
    /*$("#realentity").submit(function (e) {

     var url = "/system/user/save"; // the script where you handle the form input.

     console.log("aaa")
     $.ajax({
     type: "POST",
     url: url,
     data: $("#realentity").serialize(), // serializes the form's elements.
     success: function (data) {
     alert(data); // show response from the php script.
     }
     });

     e.preventDefault(); // avoid to execute the actual submit of the form.
     });*/


    $(document).ready(function () {

        console.log("aaa" + $("#nowid").val());

        console.log("add ready")
        if ($("#updateflag").val() == "new") {

        } else {

        }


    });

    function realtemp() {

    }

    var validateForm = $("#realentity").validate({

        // Rules for form validation
        rules: {
            name: {
                required: true
            },
            /*email: {
             required: true,
             email: true
             },*/
            contactName: {
                required: true,
                minlength: 3,
                maxlength: 20
            },
            contactTel: {
                required: true,
                minlength: 4,
                maxlength: 20
            }
        },
        // Messages for form validation
        messages: {
            username: {
                required: '请输入组织机构名称'
            },
            /*email: {
             required: '请输入电子邮箱地址',
             email: '请输入格式正确的电子邮箱地址'
             },*/
            contactName: {
                required: '请输入联系人姓名'
            },
            contactTel: {
                required: '请输入联系电话'
            }
        },

        // Do not change code below
        errorPlacement: function (error, element) {
            error.insertAfter(element.parent());
        },
        submitHandler: function (form) {
            if ($("#updateflag").val() == "new") {
                console.log("newnew");
                $.ajax({
                    url: form.action,
                    type: form.method,
                    data: $(form).serialize(),
                    success: function (response) {
                        console.log("OKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKK");
                        console.log(response);

                        if (response.substring(0, 2) == "ok") {
                            console.log("11111111111" + response);
                            $.smallBox({
                                title: "创建用户成功",
                                content: "<i class='fa fa-clock-o'></i> <i>2 seconds ago...</i>",
                                color: "#296191",
                                iconSmall: "fa fa-thumbs-up bounce animated",
                                timeout: 4000
                            });
                        }

                        else {
                            console.log("2222222" + response);

                            $.SmartMessageBox({
                                title: "出错了!",
                                content: response,
                                buttons: '[确定]'
                            })
                        }
                        $("#treetable").fancytree("getTree").reload();


                    }
                });
            } else {
                console.log("editedit");
                $("#updateflag").attr("value", 'editedit');

                $.ajax({
                    url: form.action,
                    type: form.method,
                    data: $(form).serialize(),
                    success: function (response) {

                        if (response.substring(0, 2) == "ok")
                            $.smallBox({
                                title: "修改用户成功",
                                content: "<i class='fa fa-clock-o'></i> <i>2 seconds ago...</i>",
                                color: "#296191",
                                iconSmall: "fa fa-thumbs-up bounce animated",
                                timeout: 4000
                            });
                        else {
                            $.SmartMessageBox({
                                title: "出错了!",
                                content: response,
                                buttons: '[确定]'
                            })
                        }
                        $("#treetable").fancytree("getTree").reload();
                    }
                });

            }
        }
    });


</script>
<!-- end widget content -->